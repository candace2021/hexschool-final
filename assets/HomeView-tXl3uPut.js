import{c as p,o as v,a as e,r as A,b as C,d as V,u as Z,e as x,f as H,t as z,g as X,w as M,v as Y,h as T,i as W,n as Q,F as J,j as F}from"./index-BYGXMI_p.js";import{a as f,S as L}from"./api-C2WDP3Ef.js";const N="data:image/png;base64,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",P="/hexschool-final/assets/editor-CL_41Kpm.png",G="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAC2SURBVHgBrZHBDcMgDEUBr8EQkRCDZIRO1BE6QmbomUM7BeoOSFB+JKJEwoZDfCAx8nsYrNQd4Zz7eO+X2fqlBhj8m30x5pFz3mYkgGv9BgY5YYkx/qy1b0jwRS7BRLSGEL6HYEbSgy8CScLBCN1rFW8BSYXWlJLiYFZwlpRSFAcjDCfAyYC1Zs/gOzjfGXm7Tq8LkmAAo+mQBLd9SUIjeCShGViS7FOo4HMEt0ANHrRO6KXuiD/39Lqi5pq3UwAAAABJRU5ErkJggg==",K="/hexschool-final/assets/empty-t5DgZZrr.png";class y extends Error{}y.prototype.name="InvalidTokenError";function q(i){return decodeURIComponent(atob(i).replace(/(.)/g,(n,l)=>{let a=l.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}function _(i){let n=i.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return q(n)}catch{return atob(n)}}function $(i,n){if(typeof i!="string")throw new y("Invalid token specified: must be a string");n||(n={});const l=n.header===!0?0:1,a=i.split(".")[l];if(typeof a!="string")throw new y(`Invalid token specified: missing part #${l+1}`);let d;try{d=_(a)}catch(u){throw new y(`Invalid token specified: invalid base64 for part #${l+1} (${u.message})`)}try{return JSON.parse(d)}catch(u){throw new y(`Invalid token specified: invalid json for part #${l+1} (${u.message})`)}}const O=(i,n)=>{const l=i.__vccOpts||i;for(const[a,d]of n)l[a]=d;return l},tt={},et={class:"loading"};function ot(i,n){return v(),p("div",et,[...n[0]||(n[0]=[e("span",{class:"loader"},null,-1)])])}const st=O(tt,[["render",ot]]),nt={class:"home"},at={class:"box"},lt={class:"todoBox"},it={class:"search"},rt={key:0,class:"todos"},dt={class:"btn"},ut={class:"item"},ct={class:"input"},vt=["id","checked","onClick"],At=["for"],pt={class:"listBtn"},ft=["onClick"],ht=["onClick"],gt={key:1,class:"noList"},yt={class:"total"},kt={key:1,class:"noTodo"},mt={key:0,class:"editorBox"},Ct={class:"editorContent"},St={class:"btn"},zt={__name:"HomeView",setup(i){const n=Z(),l=A({content:""}),a=A([]),d=A([]),u=A({}),k=A(!1),h=A("all"),b=A(),r=A(!0),c=C.get("token"),S=$(c),U=(S.exp-S.iat)/60/60/24;C.set("token",c,U),V(async()=>{const o=await f("get","/users/checkout",{headers:{Authorization:c}});g(),o==!1&&(C.remove("token"),n.push("/login"))});const I=async()=>{r.value=!0;try{const o=await f("post","/users/sign_out",c,{headers:{Authorization:c}});C.remove("token"),o!==void 0&&o.status&&L.fire({title:"登出成功",icon:"success",confirmButtonText:"OK"}).then(t=>{t.isConfirmed&&n.push("/login")})}finally{r.value=!1}},g=async()=>{try{const{data:o}=await f("get","/todos/",{headers:{Authorization:c}});a.value=o,d.value=o,b.value=a.value.filter(t=>t.status==!1).length,m(h.value)}finally{r.value=!1}},E=async()=>{r.value=!0;try{await f("post","/todos/",l.value,{headers:{Authorization:c}}),l.value.content="",await g()}finally{r.value=!1}},R=async o=>{r.value=!0;try{await f("patch",`/todos/${o}/toggle`,o,{headers:{Authorization:c}}),await g()}finally{r.value=!1}},j=o=>{k.value=!0,u.value={...o}},w=async()=>{r.value=!0;try{const o={id:u.value.id,content:u.value.content};await f("put",`/todos/${u.value.id}`,o,{headers:{Authorization:c}}),k.value=!1,await g()}finally{r.value=!1}},D=o=>{L.fire({title:"確認要刪除?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes"}).then(async t=>{if(t.isConfirmed){r.value=!0;try{await f("delete",`/todos/${o}`,{headers:{Authorization:c}}),await g()}finally{r.value=!1}}})},m=o=>{if(h.value=o,o=="all")return a.value=d.value;o=="unDone"?a.value=d.value.filter(t=>t.status==!1):a.value=d.value.filter(t=>t.status==!0)};return(o,t)=>(v(),p("div",nt,[e("header",null,[t[11]||(t[11]=e("div",{class:"img"},[e("img",{src:N,alt:"logo"})],-1)),e("div",at,[e("p",null,z(X(S).nickname)+"的代辦",1),e("button",{type:"button",onClick:t[0]||(t[0]=s=>I())},"登出")])]),e("div",lt,[e("div",it,[M(e("input",{type:"text",placeholder:"新增待辦事項","onUpdate:modelValue":t[1]||(t[1]=s=>l.value.content=s),onKeydown:t[2]||(t[2]=T(W(s=>E(),["prevent"]),["enter"]))},null,544),[[Y,l.value.content]]),e("button",{type:"button",onClick:t[3]||(t[3]=s=>E())},[...t[12]||(t[12]=[e("span",null,null,-1)])])]),d.value.length>0?(v(),p("div",rt,[e("div",dt,[e("button",{type:"button",class:Q({active:h.value=="all"}),onClick:t[4]||(t[4]=s=>m("all"))}," 全部 ",2),e("button",{type:"button",class:Q({active:h.value=="unDone"}),onClick:t[5]||(t[5]=s=>m("unDone"))}," 待完成 ",2),e("button",{type:"button",class:Q({active:h.value=="done"}),onClick:t[6]||(t[6]=s=>m("done"))}," 已完成 ",2)]),e("div",ut,[a.value.length>0?(v(!0),p(J,{key:0},F(a.value,s=>(v(),p("div",{class:"list",key:s.id},[e("div",ct,[e("input",{type:"checkbox",name:"",id:s.id,checked:s.status,onClick:B=>R(s.id)},null,8,vt),e("label",{for:s.id},z(s.content),9,At)]),e("div",pt,[e("button",{type:"button",class:"editor",onClick:B=>j(s)},[...t[13]||(t[13]=[e("img",{src:P,alt:"editor"},null,-1)])],8,ft),e("button",{type:"button",class:"delete",onClick:B=>D(s.id)},[...t[14]||(t[14]=[e("img",{src:G,alt:"delete"},null,-1)])],8,ht)])]))),128)):(v(),p("div",gt,"目前尚無事項"))]),e("div",yt,z(b.value)+" 個待完成項目",1)])):(v(),p("div",kt,[...t[15]||(t[15]=[e("p",null,"目前尚無待辦事項",-1),e("img",{src:K,alt:""},null,-1)])]))]),k.value?(v(),p("div",mt,[e("div",Ct,[t[16]||(t[16]=e("p",null,"修改的 Todo 內容",-1)),M(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=s=>u.value.content=s),onKeydown:t[8]||(t[8]=T(W(s=>w(),["prevent"]),["enter"]))},null,544),[[Y,u.value.content]]),e("div",St,[e("button",{type:"button",onClick:t[9]||(t[9]=s=>w())},"確認"),e("button",{type:"button",class:"white",onClick:t[10]||(t[10]=s=>k.value=!1)},"取消")])])])):x("",!0),r.value?(v(),H(st,{key:1})):x("",!0)]))}},Et=O(zt,[["__scopeId","data-v-57d97f2f"]]);export{Et as default};
